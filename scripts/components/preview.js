import { salem } from "../lib/index.js";
import { default as barcode } from './barcode.js';

export const populateUI = (props, data) => {
    const { metric, term } = props;
    const { metrics } = data;

	const filteredData = metrics[metric][term];

    const metricsContainer = document.querySelector('.metrics__container');
    metricsContainer.innerHTML = '';

    filteredData.forEach(( name, ind ) => {
        salem.createNode({
            parent: metricsContainer,
            content: `${ind + 1}. ${name}`,
            tagName: 'span',
            attributes: [
                {
                    attr: 'class',
                    value: 'mixtape__song'
                }
            ]
        });
    });
};

export default function (props, data, parent) {

	const { metric, theme, term } = props;
	const filteredData = data.metrics[metric][term];
	const username = data.user;
	const country = data.country;
	const followers = data.followers;
	const duration = data.duration;
	const qrCode = data.codeQR

	console.log(qrCode)

	const metricParent = salem.createNode({
		attributes: [
			{
				attr: 'class',
				value: `${theme} mixtape`
			}
		]
	});

	salem.createNode({
		parent: metricParent,
		attributes: [
			{
				attr: 'class',
				value: 'texture'
			}
		]
	});

	salem.createNode({
		parent: metricParent,
		content: `data from ${username} on Spotify - ${followers}`,
		attributes: [
			{
				attr: 'class',
				value: 'name__span-left'
			}
		]
	});

	const mixtapeContent = salem.createNode({
		parent: metricParent,
		attributes: [
			{
				attr: 'class',
				value: `mixtape__content left`
			}
		]
	});

	salem.createNode({
		parent: mixtapeContent,
		content: `${username} Mixtape`,
		attributes: [
			{
				attr: 'class',
				value: `mixtape__title`
			}
		]
	});


	const metricContainer = salem.createNode({
		parent: mixtapeContent,
		attributes: [
			{
				attr: 'class',
				value: 'metrics__container'
			}
		]
	});

	filteredData.forEach((name, ind) => {
		salem.createNode({
			parent: metricContainer,
			tagName: 'span',
			content: `${ind+1}. ${name}`,
			attributes: [
				{
					attr: 'class',
					value: 'mixtape__song'
				}
			]
		})
	});

	const mixtapeFooter = salem.createNode({
		parent: mixtapeContent,
		attributes: [
			{
				attr: 'class',
				value: 'footer__container'
			}
		]
	});

	const iconsFooter = salem.createNode({
		parent: mixtapeFooter,
		attributes: [
			{
				attr: 'class',
				value: 'icons__footer'
			}
		]
	});

	
	const iconsLeft = salem.createNode({
		parent: iconsFooter,
		attributes: [
			{
				attr: 'class',
				value: 'icons__left'
			}
		]
	});

	barcode(username, country, duration, iconsLeft);

	salem.createNode({
		parent: iconsLeft,
		content: `<img src=https://api.qrserver.com/v1/create-qr-code/?size=300x300&format=png&data=https://mixifysite.netlify.app//></img>`,
		attributes: [
			{
				attr: 'class',
				value: 'qr'
			}
		]
	});

	salem.createNode({
		parent: iconsFooter,
		content: `
		<svg viewBox="0 0 496 512" fill="currentColor"><path d="M248 8C111.1 8 0 119.1 0 256s111.1 248 248 248 248-111.1 248-248S384.9 8 248 8zm100.7 364.9c-4.2 0-6.8-1.3-10.7-3.6-62.4-37.6-135-39.2-206.7-24.5-3.9 1-9 2.6-11.9 2.6-9.7 0-15.8-7.7-15.8-15.8 0-10.3 6.1-15.2 13.6-16.8 81.9-18.1 165.6-16.5 237 26.2 6.1 3.9 9.7 7.4 9.7 16.5s-7.1 15.4-15.2 15.4zm26.9-65.6c-5.2 0-8.7-2.3-12.3-4.2-62.5-37-155.7-51.9-238.6-29.4-4.8 1.3-7.4 2.6-11.9 2.6-10.7 0-19.4-8.7-19.4-19.4s5.2-17.8 15.5-20.7c27.8-7.8 56.2-13.6 97.8-13.6 64.9 0 127.6 16.1 177 45.5 8.1 4.8 11.3 11 11.3 19.7-.1 10.8-8.5 19.5-19.4 19.5zm31-76.2c-5.2 0-8.4-1.3-12.9-3.9-71.2-42.5-198.5-52.7-280.9-29.7-3.6 1-8.1 2.6-12.9 2.6-13.2 0-23.3-10.3-23.3-23.6 0-13.6 8.4-21.3 17.4-23.9 35.2-10.3 74.6-15.2 117.5-15.2 73 0 149.5 15.2 205.4 47.8 7.8 4.5 12.9 10.7 12.9 22.6 0 13.6-11 23.3-23.2 23.3z"/></svg>
		<svg viewBox="0 0 432.13 264.45" fill="currentColor">
			<defs>
			<style>
				.cls-1 {
				stroke-width: 0px;
				}
			</style>
			</defs>
			<g id="Layer_1-2" data-name="Layer 1">
			<g id="g10">
				<g id="g12">
				<path id="path14" class="cls-1" d="M387.85,27.35c-.03,1.23-.07,2.24-.11,2.6-.32,2.77,0,4.07-7.98,4.07s-7.66-1.31-7.98-4.07c-.1-.9-.2-5.83-.19-8.13,0-2.31.09-7.23.19-8.13.31-2.77,0-4.07,7.98-4.07s7.66,1.31,7.98,4.07c.04.38.08,1.46.11,2.76h10.91c-.07-2.47-.19-4.54-.31-5.62-.63-5.53,1.55-10.83-18.68-10.83s-18.05,5.3-18.68,10.83c-.2,1.8-.39,6.37-.37,10.98.02,4.61.17,9.18.37,10.98.63,5.53-1.55,10.83,18.68,10.83s18.05-5.3,18.68-10.83c.12-1.05.22-3.05.29-5.45h-10.89"/>
				<path id="path16" class="cls-1" d="M258.46,1.11l-10.65,31.1-10.65-31.1-15.93-.08v41.75h10.65V11.67l10.65,31.1h10.65l10.56-31.1v31.1h10.65V1.02l-15.93.08"/>
				<path id="path18" class="cls-1" d="M401.15,1.02h30.6v10.65h-9.98v31.1h-10.65V11.67h-9.98V1.02"/>
				<path id="path20" class="cls-1" d="M319.07,42.77L331.29.98h15.87l12.24,41.79h-10.65l-2.51-8.63h-13.97l1.98-6.79h9.98l-4.95-17.02-9.56,32.44h-10.65"/>
				<path id="path22" class="cls-1" d="M195.6,9.61c7.98,0,7.66,1.31,7.98,4.07.1.9.18,5.83.19,8.13,0,2.3-.09,7.23-.19,8.13-.31,2.77,0,4.07-7.98,4.07s-7.66-1.31-7.98-4.07c-.1-.9-.2-5.83-.19-8.13,0-2.31.09-7.23.19-8.13.31-2.77,0-4.07,7.98-4.07V0c-20.22,0-18.04,5.3-18.67,10.83-.21,1.8-.39,6.37-.37,10.98.02,4.61.17,9.18.37,10.98.63,5.53-1.55,10.83,18.68,10.83s18.05-5.3,18.68-10.83c.21-1.8.36-6.37.37-10.98.02-4.61-.17-9.18-.37-10.98-.63-5.53,1.55-10.83-18.68-10.83v9.61"/>
				<path id="path24" class="cls-1" d="M159.65,27.35c-.03,1.23-.07,2.24-.11,2.6-.31,2.77,0,4.07-7.98,4.07s-7.66-1.31-7.98-4.07c-.1-.9-.2-5.83-.19-8.13,0-2.31.08-7.23.19-8.13.31-2.77,0-4.07,7.98-4.07s7.66,1.31,7.98,4.07c.04.38.08,1.46.11,2.76h10.91c-.07-2.47-.19-4.54-.31-5.62-.63-5.53,1.55-10.83-18.68-10.83s-18.05,5.3-18.68,10.83c-.2,1.8-.39,6.37-.37,10.98.02,4.61.17,9.18.37,10.98.63,5.53-1.55,10.83,18.68,10.83s18.05-5.3,18.68-10.83c.12-1.05.22-3.05.29-5.45h-10.89"/>
				<path id="path26" class="cls-1" d="M300.31,33.23h-6.46v-9.53l6.46-.04c7.98,0,7.73-1.31,8.04-4.07.1-.9.08-.16.07-2.47-.01-2.31.03-1.51-.07-2.41-.31-2.77-.07-4.08-8.04-4.08l-6.46.02v32.08s-10.66,0-10.66,0V1.02h17.12c20.23,0,18.01,5.31,18.76,10.83.09.65.09,3.67.09,5.3,0,1.31,0,4.33-.09,5.28-.51,5.55,1.47,10.79-18.76,10.79"/>
				<path id="path28" class="cls-1" d="M413.07,230.43c7.98,0,7.66,1.31,7.98,4.07.1.9.18,5.83.19,8.13.01,2.3-.08,7.23-.19,8.13-.31,2.77,0,4.07-7.98,4.07s-7.66-1.31-7.98-4.07c-.1-.9-.2-5.83-.19-8.13s.09-7.23.19-8.13c.31-2.77,0-4.07,7.98-4.07v-9.61c-20.22,0-18.04,5.3-18.67,10.83-.21,1.8-.39,6.37-.37,10.98.02,4.61.17,9.18.37,10.98.63,5.53-1.55,10.83,18.68,10.83s18.05-5.3,18.68-10.83c.21-1.8.36-6.37.37-10.98.02-4.61-.17-9.18-.37-10.98-.63-5.53,1.55-10.83-18.68-10.83v9.61"/>
				<path id="path30" class="cls-1" d="M244.55,263.19l12.21-41.79h15.87l12.24,41.79h-10.65l-2.51-8.64h-13.97l1.98-6.79h9.98l-4.95-17.02-9.56,32.44h-10.65"/>
				<path id="path32" class="cls-1" d="M155.83,263.19l12.21-41.79h15.87l12.24,41.79h-10.65l-2.52-8.64h-13.97l1.98-6.79h9.98l-4.95-17.02-9.56,32.44h-10.65"/>
				<path id="path34" class="cls-1" d="M57.72,221.84v41.75h-10.65v-41.75h10.65"/>
				<path id="path36" class="cls-1" d="M120.01,221.84v41.75h-10.65v-41.75h10.65"/>
				<path id="path38" class="cls-1" d="M125.67,221.84h30.6v10.65h-9.98v31.1h-10.65v-31.1h-9.98v-10.65"/>
				<path id="path40" class="cls-1" d="M212.61,253.03v-31.19h-10.65v41.79h27.5v-10.6h-16.85"/>
				<path id="path42" class="cls-1" d="M387.61,221.84v41.75h-10.65v-41.75h10.65"/>
				<path id="path44" class="cls-1" d="M345.65,221.87h5.78c20.23,0,18.05,5.32,18.68,10.86.2,1.8.39,5.03.37,9.64-.02,4.61-.17,8.59-.37,10.4-.63,5.53,1.55,10.83-18.68,10.83h-18.57v-41.72h12.79l-.17,9.59h-1.93s0,22.61,0,22.61l7.87-.08c7.98,0,7.66-1.31,7.98-4.07.1-.9.2-5.24.19-7.54,0-2.31-.09-5.89-.19-6.79-.31-2.77,0-4.07-7.98-4.07l-5.94-.04.17-9.59"/>
				<path id="path46" class="cls-1" d="M325.88,242.63v-20.79h-10.89v20.79c0,2.3-.09,7.23-.19,8.13-.31,2.77,0,4.07-7.98,4.07s-7.66-1.31-7.98-4.07c-.1-.9-.18-5.83-.17-8.13l.02-20.79h-10.91v20.79c.02,4.61.17,9.18.37,10.98.63,5.53-1.55,10.83,18.68,10.83s18.05-5.3,18.68-10.83c.2-1.8.34-6.37.36-10.98"/>
				<path id="path48" class="cls-1" d="M91.6,248.17c-.03,1.23-.07,2.24-.11,2.6-.31,2.77,0,4.07-7.98,4.07s-7.66-1.31-7.98-4.07c-.1-.9-.2-5.83-.19-8.13,0-2.3.08-7.23.19-8.13.31-2.77,0-4.07,7.98-4.07s7.66,1.31,7.98,4.07c.04.38.08.12.11,1.42h10.91c-.07-2.47-.19-3.2-.31-4.28-.63-5.53,1.55-10.83-18.68-10.83s-18.05,5.3-18.68,10.83c-.2,1.8-.39,6.37-.38,10.98.02,4.61.17,9.18.38,10.98.63,5.53-1.55,10.83,18.68,10.83s18.05-5.3,18.68-10.83c.12-1.05.22-3.05.29-5.45h-10.89"/>
				<path id="path50" class="cls-1" d="M83.5,241.46v6.71h18.99v-6.71h-18.99"/>
				<path id="path52" class="cls-1" d="M15.43,221.87h5.78c20.23,0,18.05,5.32,18.68,10.86.21,1.8.39,5.03.38,9.64-.02,4.61-.17,8.59-.38,10.4-.63,5.53,1.55,10.83-18.68,10.83H2.64v-41.72h12.79l-.17,9.59h-1.93s0,22.61,0,22.61l7.87-.08c7.98,0,7.66-1.31,7.98-4.07.1-.9.2-5.24.19-7.54,0-2.31-.08-5.89-.19-6.79-.31-2.77,0-4.07-7.98-4.07l-5.94-.04.17-9.59"/>
				<path id="path54" class="cls-1" d="M93.26,199.98l-66.64-.08c-9.64,0-17.46-7.82-17.46-17.46v-101.44c0-9.64,7.82-17.46,17.46-17.46l41.71-.05c5.01,0,9.07-4.06,9.07-9.07l.12-40.56c0-2.1,1.7-3.8,3.8-3.8h24.45c2.1,0,3.8,1.7,3.8,3.8l.25,182.32c0,2.1-1.7,3.8-3.8,3.8h-12.76s-.31,9.04-.31,9.04h16.68c5.01,0,9.07-4.07,9.07-9.07V9.99c0-5.01-4.06-9.07-9.07-9.07h-32.08c-5.01,0-9.07,4.06-9.07,9.07l.05,40.66c0,2.1-1.7,3.8-3.8,3.8l-38.1-.07c-14.7,0-26.62,11.91-26.62,26.61v101.44c0,14.7,11.92,26.62,26.62,26.62l66.33-.02.31-9.06"/>
				<path id="path56" class="cls-1" d="M68.48,162.64v-65.63c0-5.5-4.46-9.96-9.96-9.96s-9.96,4.46-9.96,9.96v70.84c0,5.5,4.46,9.96,9.96,9.96s9.96-4.46,9.96-9.96v-5.21l9.05.31v4.9c0,10.5-8.51,19.01-19.01,19.01s-19.01-8.51-19.01-19.01v-70.84c0-10.5,8.51-19.01,19.01-19.01s19.01,8.51,19.01,19.01v65.94l-9.05-.31"/>
				<path id="path58" class="cls-1" d="M156.6,199.98h-12.47c-2.1,0-3.8-1.7-3.8-3.8l.15-128.75c0-2.1,1.7-3.8,3.8-3.8h24.45c2.1,0,3.8,1.7,3.8,3.8l.25,128.75c0,2.1-1.7,3.8-3.8,3.8h-12.38v9.02l15.99.02c5.01,0,9.07-4.06,9.07-9.07V63.55c0-5.01-4.06-9.07-9.07-9.07h-32.08c-5.01,0-9.07,4.06-9.07,9.07l-.02,136.36c0,5.01,4.03,9.07,9.04,9.07l16.14.02v-9.02"/>
				<path id="path60" class="cls-1" d="M271.8,88.96l-26.86-.04c-8.27,0-14.97,6.7-14.97,14.97s6.7,14.97,14.97,14.97l36.8.1c9.64,0,17.46,7.82,17.46,17.46l-.12,45.82c0,9.64-7.82,17.46-17.46,17.46l-73.06.13c-2.1,0-3.8-1.7-3.8-3.8v-17.74c0-2.1,1.7-3.8,3.8-3.8l49.79-.16c8.27,0,14.97-6.7,14.97-14.97s-6.7-14.97-14.97-14.97l-36.05-.14c-9.64,0-17.46-7.82-17.46-17.46v-45.77c0-9.64,7.82-17.46,17.46-17.46l67.72-.32c2.1,0,3.8,1.7,3.8,3.8v18.15c0,2.1-1.7,3.8-3.8,3.8l-18.23-.03-.31,8.92h22.27c5.01,0,9.07-4.02,9.07-9.03l.03-25.42c0-5.01-4.06-9.07-9.07-9.07l-71.5.03c-14.7,0-26.61,11.91-26.61,26.61v45.77c0,14.7,11.92,26.62,26.61,26.62l36.05-.06c3.32,0,6.02,2.69,6.02,6.02s-2.69,6.02-6.02,6.02h-53.67c-5.01-.01-9.07,4.05-9.07,9.06v25.37c0,5.01,4.06,9.07,9.07,9.07l76.93-.02c14.7,0,26.61-11.92,26.61-26.62l.12-45.82c0-14.7-11.92-26.61-26.61-26.61l-36.8.11c-3.32,0-6.02-2.69-6.02-6.02s2.69-6.01,6.02-6.01h26.55s.31-8.92.31-8.92"/>
				<path id="path62" class="cls-1" d="M407.17,114.13h11.54c2.1,0,3.8-1.7,3.8-3.8l-.05-29.32c0-9.64-7.82-17.46-17.46-17.46h-57.72c-9.64,0-17.46,7.82-17.46,17.46v101.44c0,9.64,7.82,17.46,17.46,17.46h57.72c9.64,0,17.46-7.82,17.46-17.46l.05-27.88c0-2.1-1.7-3.8-3.8-3.8h-21.77c-2.1,0-3.8,1.7-3.8,3.8l.12,13.29c0,10.5-6.61,19.01-17.11,19.01s-17.11-8.51-17.11-19.01v-70.84c0-10.5,6.61-19.01,17.11-19.01s17.11,8.51,17.11,19.01l-.12,13.31c0,2.1,1.7,3.8,3.8,3.8h10.24l-.31,9.14h-13.7c-5.01,0-9.07-4.06-9.07-9.07l.11-17.19c0-5.5-2.56-9.96-8.06-9.96s-8.06,4.46-8.06,9.96v70.84c0,5.5,2.56,9.96,8.06,9.96s8.06-4.46,8.06-9.96l-.11-17.17c0-5.01,4.06-9.07,9.07-9.07h29.4c5.01,0,9.07,4.06,9.07,9.07l-.02,31.76c0,14.7-11.92,26.62-26.62,26.62h-57.72c-14.7,0-26.62-11.92-26.62-26.62v-101.44c0-14.7,11.92-26.61,26.62-26.61h57.72c14.7,0,26.62,11.91,26.62,26.61l.02,33.2c0,5.01-4.06,9.07-9.07,9.07h-15.7l.31-9.14"/>
				</g>
			</g>
			</g>
	  	</svg>`,
		attributes: [
			{
				attr: 'class',
				value: 'icons__brands'
			}
		]
	});

	salem.createNode({
		parent: mixtapeFooter,
		tagName: 'span',
		content: `2024 Webpage made by Jelly.flac. Top data from ${username} on Spotify, under exclusive license to Spotify, Inc. Made in Venezuela with love. WARNING: all rights reserved. ©`,
		attributes: [
			{
				attr: 'class',
				value: 'footer__text'
			}
		]
	});

	salem.createNode({
		parent: metricParent,
		content: `data from ${username} on Spotify - ${followers}`,
		attributes: [
			{
				attr: 'class',
				value: 'name__span-right'
			}
		]
	});

	salem.render({parent, node: metricParent});

}